<UserControl x:Class="The_movie_egen.UI.View.TimelineView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header med tidslinje -->
        <Border Grid.Row="0" 
                Background="{StaticResource Brush.Surface2}"
                BorderBrush="{StaticResource Brush.Border}"
                BorderThickness="0,0,0,1"
                Padding="8,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" 
                           Text="Tid"
                           Foreground="{StaticResource Brush.TextMuted}"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center"/>

                <!-- 24-timers tidslinje -->
                <Canvas Grid.Column="1" x:Name="TimelineCanvas">
                    <!-- Time markers -->
                    <TextBlock Canvas.Left="0" Canvas.Top="2" Text="00:00" 
                               Foreground="{StaticResource Brush.TextMuted}" 
                               FontSize="10"/>
                    <TextBlock Canvas.Left="60" Canvas.Top="2" Text="06:00" 
                               Foreground="{StaticResource Brush.TextMuted}" 
                               FontSize="10"/>
                    <TextBlock Canvas.Left="120" Canvas.Top="2" Text="12:00" 
                               Foreground="{StaticResource Brush.TextMuted}" 
                               FontSize="10"/>
                    <TextBlock Canvas.Left="180" Canvas.Top="2" Text="18:00" 
                               Foreground="{StaticResource Brush.TextMuted}" 
                               FontSize="10"/>
                    <TextBlock Canvas.Left="240" Canvas.Top="2" Text="24:00" 
                               Foreground="{StaticResource Brush.TextMuted}" 
                               FontSize="10"/>

                    <!-- Time grid lines -->
                    <Line Canvas.Left="0" Canvas.Top="20" X2="240" Y2="20" 
                          Stroke="{StaticResource Brush.Border}" StrokeThickness="1"/>
                    <Line Canvas.Left="60" Canvas.Top="20" X2="60" Y2="40" 
                          Stroke="{StaticResource Brush.Border}" StrokeThickness="0.5"/>
                    <Line Canvas.Left="120" Canvas.Top="20" X2="120" Y2="40" 
                          Stroke="{StaticResource Brush.Border}" StrokeThickness="0.5"/>
                    <Line Canvas.Left="180" Canvas.Top="20" X2="180" Y2="40" 
                          Stroke="{StaticResource Brush.Border}" StrokeThickness="0.5"/>
                    <Line Canvas.Left="240" Canvas.Top="20" X2="240" Y2="40" 
                          Stroke="{StaticResource Brush.Border}" StrokeThickness="0.5"/>
                </Canvas>
            </Grid>
        </Border>

        <!-- Scrollable content -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Auto">
            <ItemsControl x:Name="TimelineItemsControl">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="0,2" 
                                Background="{StaticResource Brush.Surface}"
                                BorderBrush="{StaticResource Brush.Border}"
                                BorderThickness="0,0,0,1"
                                Padding="8,4">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Date/Auditorium info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{Binding DateText}" 
                                               Foreground="{StaticResource Brush.Text}"
                                               FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding AuditoriumName}" 
                                               Foreground="{StaticResource Brush.TextMuted}"
                                               FontSize="11"/>
                                </StackPanel>

                                <!-- Timeline with movie blocks -->
                                <Canvas Grid.Column="1" 
                                        x:Name="MovieTimeline"
                                        Height="40"
                                        Background="Transparent">
                                    
                                    <!-- Movie blocks -->
                                    <ItemsControl ItemsSource="{Binding Screenings}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <Canvas/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Canvas.Left="{Binding TimelinePosition}"
                                                        Canvas.Top="5"
                                                        Width="{Binding TimelineWidth}"
                                                        Height="30"
                                                        Background="{Binding MovieColor}"
                                                        BorderBrush="{StaticResource Brush.Border}"
                                                        BorderThickness="1"
                                                        CornerRadius="4"
                                                        Cursor="Hand"
                                                        ToolTip="{Binding TooltipText}">
                                                    
                                                    <TextBlock Text="{Binding MovieTitle}"
                                                               Foreground="White"
                                                               FontWeight="SemiBold"
                                                               FontSize="11"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               TextTrimming="CharacterEllipsis"
                                                               Margin="4,0"/>
                                                    
                                                    <!-- Click event for editing -->
                                                    <Border.InputBindings>
                                                        <MouseBinding MouseAction="LeftClick" 
                                                                      Command="{Binding DataContext.EditScreeningCommand, 
                                                                                RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                      CommandParameter="{Binding}"/>
                                                    </Border.InputBindings>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Canvas>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>
