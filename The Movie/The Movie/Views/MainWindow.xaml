<Window
    x:Class="The_Movie.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:The_Movie"
    xmlns:viewmodels="clr-namespace:The_Movie.ViewModels"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="The Movie - Biograf System"
    Width="1000"
    Height="600"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">

    <Window.DataContext>
        <viewmodels:MainViewModel/>
    </Window.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header med søgning og handlinger -->
        <Border Grid.Row="0" 
                Background="LightSteelBlue" 
                Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" 
                           Orientation="Horizontal">
                    <Label Content="Søg:" 
                           VerticalAlignment="Center"/>
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                             Width="200"
                             ToolTip="Søg efter film titel eller genre"/>
                    <Button Click="RefreshButton_Click"
                            Content="Opdater"
                            ToolTip="Opdater film liste"
                            Margin="5"/>
                </StackPanel>

                <StackPanel Grid.Column="1" 
                           Orientation="Horizontal">
                    <Button Click="AddMovieButton_Click"
                            Content="Registrer Ny Film"
                            Background="LightGreen"
                            Margin="5"
                            Padding="10,5"/>
                    <Button Click="EditMovieButton_Click"
                            Content="Rediger Film"
                            Background="LightYellow"
                            Margin="5"
                            Padding="10,5"/>
                    <Button Click="DeleteMovieButton_Click"
                            Content="Slet Film"
                            Background="LightCoral"
                            Margin="5"
                            Padding="10,5"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Hovedindhold -->
        <Grid Grid.Row="1" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>

            <!-- Film liste -->
            <GroupBox Grid.Column="0" 
                      Header="Film Oversigt" 
                      Padding="5">
                <DataGrid ItemsSource="{Binding FilteredMovies}"
                          SelectedItem="{Binding SelectedMovie}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          GridLinesVisibility="Horizontal"
                          AlternatingRowBackground="LightGray">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" 
                                          Binding="{Binding Id}" 
                                          Width="50"/>
                        <DataGridTextColumn Header="Titel" 
                                          Binding="{Binding Name}" 
                                          Width="*"/>
                        <DataGridTextColumn Header="Varighed" 
                                          Binding="{Binding DurationFormatted}" 
                                          Width="100"/>
                        <DataGridTextColumn Header="Genre" 
                                          Binding="{Binding Genre}" 
                                          Width="120"/>
                    </DataGrid.Columns>
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <EventSetter Event="MouseDoubleClick" 
                                       Handler="DataGridRow_MouseDoubleClick"/>
                        </Style>
                    </DataGrid.RowStyle>
                </DataGrid>
            </GroupBox>

            <GridSplitter Grid.Column="1" 
                         HorizontalAlignment="Stretch"
                         Background="Gray"/>

            <!-- Film detaljer -->
            <GroupBox Grid.Column="2" 
                      Header="Film Detaljer" 
                      Padding="10">
                <Grid>
                    <!-- Film detaljer når film er valgt -->
                    <StackPanel DataContext="{Binding SelectedMovie}">
                        <StackPanel.Style>
                            <Style TargetType="StackPanel">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </StackPanel.Style>

                        <Label Content="Film Information:" 
                               FontWeight="Bold" 
                               FontSize="14"/>

                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <Label Content="ID:" Width="70"/>
                            <TextBlock Text="{Binding Id}" 
                                     VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <Label Content="Titel:" Width="70"/>
                            <TextBlock Text="{Binding Name}" 
                                     VerticalAlignment="Center"
                                     TextWrapping="Wrap"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <Label Content="Varighed:" Width="70"/>
                            <TextBlock Text="{Binding DurationFormatted}" 
                                     VerticalAlignment="Center"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <Label Content="Genre:" Width="70"/>
                            <TextBlock Text="{Binding Genre}" 
                                     VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Besked når ingen film er valgt -->
                    <TextBlock Text="Vælg en film for at se detaljer"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              FontStyle="Italic"
                              Foreground="Gray">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedMovie}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </GroupBox>
        </Grid>

        <!-- Status bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock>
                    <Run Text="Antal Film: "/>
                    <Run Text="{Binding FilteredMovies.Count, Mode=OneWay}"/>
                    <Run Text=" | Valgt: "/>
                    <Run Text="{Binding SelectedMovie.Name, TargetNullValue='Ingen'}"/>
                </TextBlock>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>